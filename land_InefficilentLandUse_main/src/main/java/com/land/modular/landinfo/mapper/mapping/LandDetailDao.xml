<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.land.modular.landinfo.mapper.LandDetailDao">

    <resultMap type="com.land.modular.landinfo.entity.LandDetailInfo" id="LandInfoMap">
        <result property="id" column="id" jdbcType="BIGINT"/>
        <result property="createTime" column="create_time" jdbcType="TIMESTAMP"/>
        <result property="createUser" column="create_user" jdbcType="INTEGER"/>
        <result property="createUserName" column="create_user_name" jdbcType="VARCHAR"/>
        <result property="updateTime" column="update_time" jdbcType="TIMESTAMP"/>
        <result property="updateUser" column="update_user" jdbcType="INTEGER"/>
        <result property="updateUserName" column="update_user_name" jdbcType="VARCHAR"/>
        <result property="xmc" column="xmc" jdbcType="VARCHAR"/>
        <result property="pqbh" column="pqbh" jdbcType="VARCHAR"/>
        <result property="xmmc" column="xmmc" jdbcType="VARCHAR"/>
        <result property="xzmc" column="xzmc" jdbcType="BIGINT"/>
        <result property="dkbh" column="dkbh" jdbcType="VARCHAR"/>
        <result property="dkmj" column="dkmj" jdbcType="DOUBLE"/>
        <result property="dldm" column="dldm" jdbcType="VARCHAR"/>
        <result property="dlmc" column="dlmc" jdbcType="VARCHAR"/>
        <result property="xldm" column="xldm" jdbcType="CHAR"/>
        <result property="xlmc" column="xlmc" jdbcType="VARCHAR"/>
        <result property="xzyt" column="xzyt" jdbcType="VARCHAR"/>
        <result property="xzrjl" column="xzrjl" jdbcType="DOUBLE"/>
        <result property="xzjzmd" column="xzjzmd" jdbcType="INTEGER"/>
        <result property="ghyt" column="ghyt" jdbcType="CHAR"/>
        <result property="ghrjl" column="ghrjl" jdbcType="VARCHAR"/>
        <result property="ghjzmd" column="ghjzmd" jdbcType="BIGINT"/>
        <result property="kfql" column="kfql" jdbcType="DOUBLE"/>
        <result property="zkfsx" column="zkfsx" jdbcType="VARCHAR"/>
        <result property="pqmj" column="pqmj" jdbcType="DOUBLE"/>
        <result property="zb" column="zb" jdbcType="VARCHAR"/>
        <result property="remark" column="remark" jdbcType="VARCHAR"/>
        <result property="businessKey" column="business_key" jdbcType="VARCHAR"/>
        <result property="landCode" column="land_code" jdbcType="VARCHAR"/>
        <result property="landStatus" column="land_status" jdbcType="VARCHAR"/>
        <result property="category" column="category" jdbcType="VARCHAR"/>

        <result property="zbq" column="zbq" jdbcType="VARCHAR"/>
        <result property="qymc" column="qymc" jdbcType="VARCHAR"/>
        <result property="bdcqzsh" column="bdcqzsh" jdbcType="VARCHAR"/>
        <result property="crsj" column="crsj" jdbcType="VARCHAR"/>
        <result property="htrjl" column="htrjl" jdbcType="VARCHAR"/>
        <result property="httzqd" column="httzqd" jdbcType="VARCHAR"/>
        <result property="htmjss" column="htmjss" jdbcType="VARCHAR"/>
        <result property="hydm" column="hydm" jdbcType="VARCHAR"/>
        <result property="hymc" column="hymc" jdbcType="VARCHAR"/>
        <result property="rjljsz" column="rjljsz" jdbcType="VARCHAR"/>
        <result property="dkrjl" column="dkrjl" jdbcType="VARCHAR"/>
        <result property="rjlfz" column="rjlfz" jdbcType="VARCHAR"/>
        <result property="tzqdfz" column="tzqdfz" jdbcType="DOUBLE"/>
        <result property="tzqdjs" column="tzqdjs" jdbcType="DOUBLE"/>
        <result property="dktzqd" column="dktzqd" jdbcType="VARCHAR"/>
        <result property="ssccljs" column="ssccljs" jdbcType="DOUBLE"/>
        <result property="dkssccl" column="dkssccl" jdbcType="VARCHAR"/>
        <result property="dksscclfz" column="dksscclfz" jdbcType="DOUBLE"/>
        <result property="bmysfz" column="bmysfz" jdbcType="DOUBLE"/>
        <result property="zfysfz" column="zfysfz" jdbcType="DOUBLE"/>
        <result property="zhdf" column="zhdf" jdbcType="DOUBLE"/>
        <result property="xdm" column="xdm" jdbcType="VARCHAR"/>
        <result property="year" column="year" jdbcType="INTEGER"/>
        <result property="cbhs" column="cbhs" jdbcType="VARCHAR"/>
        <result property="xyqd" column="xyqd" jdbcType="VARCHAR"/>
        <result property="tdgy" column="tdgy" jdbcType="VARCHAR"/>
        <result property="ghtjbg" column="ghtjbg" jdbcType="VARCHAR"/>
        <result property="ghgcsp" column="ghgcsp" jdbcType="VARCHAR"/>
        <result property="cxrd" column="cxrd" jdbcType="VARCHAR"/>
        <result property="tsfabz" column="tsfabz" jdbcType="VARCHAR"/>
        <result property="tsfzss" column="tsfzss" jdbcType="VARCHAR"/>
        <result property="tscxzm" column="tscxzm" jdbcType="VARCHAR"/>
        <result property="xmlx" column="xmlx" jdbcType="VARCHAR"/>
        <result property="xmsg" column="xmsg" jdbcType="VARCHAR"/>
        <result property="xmys" column="xmys" jdbcType="VARCHAR"/>
        <result property="xmzbsy" column="xmzbsy" jdbcType="VARCHAR"/>
        <result property="jbqk" column="jbqk" jdbcType="VARCHAR"/>
        <result property="dktj" column="dktj" jdbcType="VARCHAR"/>
        <result property="sczkfjz" column="sczkfjz" jdbcType="VARCHAR"/>
        <result property="scStatus" column="sc_status" jdbcType="VARCHAR"/>

        <result property="sfss" column="sfss" jdbcType="VARCHAR"/>
        <result property="wssyy" column="wssyy" jdbcType="VARCHAR"/>
        <result property="tjyy" column="tjyy" jdbcType="VARCHAR"/>
        <result property="zzss" column="zzss" jdbcType="VARCHAR"/>
        <result property="kssj" column="kssj" jdbcType="VARCHAR"/>
        <result property="ywc" column="ywc" jdbcType="VARCHAR"/>
        <result property="wcsj" column="wcsj" jdbcType="VARCHAR"/>


    </resultMap>
    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
      id ,XMC as xmc ,PQBH as pqbh,XMMC as xmmc,XZDM as xzdm,XZMC as xzmc,DKBH as dkbh,DKMJ as dkmj,DLDM as dldm,DLMC as dlmc,XLDM as xldm,XLMC xlmc,XZYT xzyt,
      XZRJL xzrjl,XZJZMD xzjzmd,GHYT ghyt,GHRJL ghrjl,ghgcsp,wcsj,ywc,kssj,zzss,tjyy,sfss,wssyy,
	GHJZMD ghjzmd,KFQL kfql,ZKFSX zkfsx,PQMJ pqmj,ZB  zb,create_user as createUser,create_user_name as createUserName,category as category,land_code as landCode,
	land_status as landStatus,zbq,qymc,bdcqzsh,crsj,htrjl,httzqd,htmjss,hydm,hymc,rjljsz,dkrjl,rjlfz,tzqdfz,tzqdjs,dktzqd,ssccljs,dkssccl,dksscclfz,bmysfz,
	zfysfz,zhdf,xdm,year,cbhs,tdgy,xyqd,ghtjbg,cxrd,tsfabz,tscxzm,xmlx,xmsg,xmys,xmzbsy,jbqk,dktj,sczkfjz,sc_status as scStatus,
	create_time as createTime,update_user as updateUser,update_user_name as updateUserName ,update_time as updateTime,remark,business_key as businessKey
    </sql>
    <select id="selectListByPage" resultType="java.util.Map">
        select
        <include refid="Base_Column_List"/>
        from land_low_use.land_detail_info
        where 1=1
        <if test="beginTime != null and beginTime != ''">
            and create_time >= CONCAT(#{beginTime},' 00:00:00')
        </if>
        <if test="endTime != null and endTime != ''">
            and create_time &lt;=CONCAT(#{endTime},' 23:59:59')
        </if>
        <if test="vo.category != null and vo.category != ''">
            and category = #{vo.category}
        </if>
        <if test="vo.xdm != null and vo.xdm != ''">
            and xdm = #{vo.xdm}
        </if>
        <if test="vo.xmmc != null and vo.xmmc != ''">
            and xmmc like CONCAT('%',#{vo.xmmc},'%')
        </if>
        <if test="vo.landStatus != null and vo.landStatus != ''">
            and land_status = #{vo.landStatus}
        </if>
        <if test="vo.landCode != null and vo.landCode != ''">
            and land_code = #{vo.landCode}
        </if>
        order by xdm,pqbh, create_time desc
    </select>
    <select id="selectByList" resultType="com.land.modular.landinfo.entity.LandDetailInfo">
        select
        <include refid="Base_Column_List"/>
        from land_low_use.land_detail_info
        where 1=1
        <if test="vo.category != null and vo.category != ''">
            and category = #{vo.category}
        </if>
        <if test="vo.xdm != null and vo.xdm != ''">
            and xdm = #{vo.xdm}
        </if>
        <if test="vo.xmmc != null and vo.xmmc != ''">
            and xmmc like CONCAT('%',#{vo.xmmc},'%')
        </if>
        <if test="beginTime != null and beginTime != ''">
            and create_time >= CONCAT(#{beginTime},' 00:00:00')
        </if>
        <if test="endTime != null and endTime != ''">
            and create_time &lt;=CONCAT(#{endTime},' 23:59:59')
        </if>
        order by create_time desc
    </select>
    <select id="getDetailById" resultType="com.land.modular.landinfo.vo.LandDetailInfoVo">
        select
        <include refid="Base_Column_List"/>
        from land_detail_info
        where id = #{id}
    </select>

    <select id="getByYearAndQx" resultType="com.land.modular.landinfo.entity.LandDetailInfo">
        select
        <include refid="Base_Column_List"/>
        from land_detail_info
        where year = #{year}
        and xdm = #{xdm}
        order by create_time desc limit 1
    </select>

    <select id="getOneById" resultMap="LandInfoMap">
        select
        <include refid="Base_Column_List"/>
        from land_detail_info
        where id = #{id}
    </select>

    <select id="landStaList"  resultType="java.util.Map">
        select xmc,year,category,dlmc,xlmc,xzyt,count(1) as landNum,sum(dkmj) as landArea
        from land_detail_info
        where 1=1
        <if test="vo.category != null and vo.category != ''">
            and category = #{vo.category}
        </if>
        <if test="vo.xdm != null and vo.xdm != ''">
            and xdm = #{vo.xdm}
        </if>
        <if test="beginTime != null and beginTime != ''">
            and create_time >= CONCAT(#{beginTime},' 00:00:00')
        </if>
        <if test="endTime != null and endTime != ''">
            and create_time &lt;=CONCAT(#{endTime},' 23:59:59')
        </if>
        group by xmc,year,category,dlmc,xlmc,xzyt
        order by xmc,year
    </select>

    <select id="cycleStaList" resultType="java.util.Map">
        select xmc,year,land_status as landStatus,dlmc,xlmc,xzyt,count(1) as landNum,sum(dkmj) as landArea
        from land_detail_info
        where 1=1
        <if test="vo.landStatus != null and vo.landStatus != ''">
            and land_status = #{vo.landStatus}
        </if>
        <if test="vo.xdm != null and vo.xdm != ''">
            and xdm = #{vo.xdm}
        </if>
        <if test="beginTime != null and beginTime != ''">
            and create_time >= CONCAT(#{beginTime},' 00:00:00')
        </if>
        <if test="endTime != null and endTime != ''">
            and create_time &lt;=CONCAT(#{endTime},' 23:59:59')
        </if>
        group by xmc,year,land_status,dlmc,xlmc,xzyt
        order by xmc,year
    </select>
</mapper>