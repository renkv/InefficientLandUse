(function(e){function t(t){for(var i,l,s=t[0],a=t[1],c=t[2],d=0,p=[];d<s.length;d++)l=s[d],Object.prototype.hasOwnProperty.call(n,l)&&n[l]&&p.push(n[l][0]),n[l]=0;for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i]);u&&u(t);while(p.length)p.shift()();return r.push.apply(r,c||[]),o()}function o(){for(var e,t=0;t<r.length;t++){for(var o=r[t],i=!0,s=1;s<o.length;s++){var a=o[s];0!==n[a]&&(i=!1)}i&&(r.splice(t--,1),e=l(l.s=o[0]))}return e}var i={},n={app:0},r=[];function l(t){if(i[t])return i[t].exports;var o=i[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,l),o.l=!0,o.exports}l.m=e,l.c=i,l.d=function(e,t,o){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(l.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)l.d(o,i,function(t){return e[t]}.bind(null,i));return o},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],a=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=a;r.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"2b84":function(e,t,o){"use strict";o("647f")},5375:function(e,t,o){},"56d7":function(e,t,o){"use strict";o.r(t);var i=o("a2e7"),n=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("CesiumGeoJson")],1)},r=[],l=function(){var e=this,t=e._self._c;return t("el-container",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%",height:"100%"},attrs:{"element-loading-text":"","element-loading-background":"rgba(0, 0, 0, 0.75)"}},[t("el-header",{staticStyle:{"background-color":"#545c64",display:"flex","align-items":"center","justify-content":"space-between"}},[t("el-autocomplete",{attrs:{"fetch-suggestions":e.querySearch,placeholder:"搜索","trigger-on-focus":!1},on:{select:e.handleSelect},scopedSlots:e._u([{key:"default",fn:function({item:o}){return[t("div",{staticStyle:{"text-overflow":"ellipsis",overflow:"hidden","font-size":"12px",color:"#666"},attrs:{title:o.value}},[e._v(e._s(o.value))])]}}]),model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},[e.keyword?t("i",{staticClass:"el-icon-close el-input__icon",staticStyle:{cursor:"pointer"},attrs:{slot:"suffix"},on:{click:e.handleIconClear},slot:"suffix"}):t("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},slot:"suffix"})]),t("div",{staticStyle:{"flex-grow":"1"}}),t("div",{staticStyle:{display:"flex","column-gap":"30px"}},[e._l(e.geo_list,(function(o,i){return t("el-link",{key:i,attrs:{icon:"el-icon-folder",type:e.current===i?"warning":"info"},on:{click:function(t){return e.handleGeoClick(o,i)}}},[e._v(e._s(o.name))])})),t("el-link",{attrs:{icon:"el-icon-setting",type:"info"},on:{click:e.handleHome}},[e._v("复位")]),t("el-link",{attrs:{icon:"el-icon-setting",type:e.visible?"warning":"info"},on:{click:e.handleShow}},[e._v("属性")])],2)],1),t("el-main",{staticStyle:{padding:"0",position:"relative",overflow:"hidden"}},[t("div",{staticStyle:{width:"100%",height:"100%"},attrs:{id:"cesiumContainer"}}),t("div",{staticStyle:{position:"absolute",top:"0",right:"0",width:"25%",height:"100%","background-color":"rgba(255, 255, 255, 1)","border-left":"1px solid #ccc",transition:"all .2s linear"},style:{transform:e.visible?"translateX(0)":"translateX(100%)"}},[t("div",{staticStyle:{width:"100%",height:"100%","overflow-y":"auto"}},[t("table",e._l(e.selectItem.properties,(function(o,i){return t("tr",[t("td",[e._v(e._s(o.key))]),t("td",[e._v(e._s(o.value))])])})),0)])])])],1)},s=[],a=null,c=new Cesium.Color(1,1,0,.39),u=new Cesium.Color(1,1,0,1),d=new Cesium.Color(1,0,0,.39),p=new Cesium.Color(1,0,0,1);function f(e){var t=document.createElement("a");t.href=e||window.location.href;var o=t.search.substring(1),i={};return o.split("&").forEach((function(e){var t=e.split("=");i[decodeURIComponent(t[0])]=decodeURIComponent(t[1]||"")})),i}var h={name:"CesiumGeoJson",data(){return{current:0,geo_list:geo_list,loading:!1,visible:!1,keyword:null,restaurants:[],selectItem:{}}},mounted(){a=new Cesium.Viewer("cesiumContainer",{imageryProvider:new Cesium.SingleTileImageryProvider({url:"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="}),baseLayerPicker:!1,animation:!1,fullscreenButton:!1,vrButton:!1,geocoder:!1,homeButton:!1,infoBox:!1,sceneModePicker:!1,selectionIndicator:!1,timeline:!1,navigationHelpButton:!1,navigationInstructionsInitiallyVisible:!1,scene3DOnly:!0,shouldAnimate:!1,skyBox:!1}),window.viewer=a,a.cesiumWidget.creditContainer.style.display="none",a.imageryLayers.addImageryProvider(new Cesium.WebMapTileServiceImageryProvider({url:"http://t0.tianditu.gov.cn/img_w/wmts?tk="+td_key,layer:"img",style:"default",tileMatrixSetID:"w",format:"tiles",maximumLevel:18})),a.imageryLayers.addImageryProvider(new Cesium.WebMapTileServiceImageryProvider({url:"http://t0.tianditu.gov.cn/cia_w/wmts?tk="+td_key,layer:"cia",style:"default",tileMatrixSetID:"w",format:"tiles",maximumLevel:18}));var e=new Cesium.ScreenSpaceEventHandler(a.canvas);e.setInputAction(e=>{var t=a.scene.pick(e.position);if(Cesium.defined(t)&&t.primitive){const e=t.id,o=e.properties,i=o.propertyNames;this.selectItem={properties:i.map(e=>({key:e,value:o[e]._value}))},this.visible=!0,this.clearEntitysColor(this.restaurants),this.selectEntityColor(e)}else this.keyword||(this.visible=!1,this.selectItem={},this.clearEntitysColor(this.restaurants))},Cesium.ScreenSpaceEventType.LEFT_CLICK);const{path:t,key:o,value:i,style:n}=f();if(t&&o&&i)this.loadGeoJson({path:t},()=>{const e=this.restaurants.find(e=>{const{entity:t}=e;return t.properties[o]==i});this.selectItem=e,this.selectEntityColor(e.entity),this.visible=!0,a.flyTo(e.entity)});else{const{geo_list:e,current:t}=this,o=e[t];this.loadGeoJson(o)}},methods:{querySearch(e,t){var o=this.restaurants,i=e?o.filter(this.createFilter(e)):o;t(i)},createFilter(e){return t=>t.value.toLowerCase().includes(e)},handleSelect(e){const{entity:t,properties:o}=e;this.selectItem=e,this.clearEntitysColor(this.restaurants),this.selectEntityColor(t),a.flyTo(t)},handleIconClear(){this.selectItem={},this.keyword=null,this.clearEntitysColor(this.restaurants)},handleGeoClick(e,t){a.dataSources.removeAll(),this.current=t,this.loadGeoJson(e)},handleHome(){a.flyTo(a.dataSources._dataSources[0])},handleShow(){this.visible=!this.visible},clearEntitysColor(e){const{geo_list:t,current:o}=this,{styles:i}=t[o];e.forEach(({entity:e})=>{e.polygon.extrudedHeight=0,e.polygon.outlineColor=i&&i.strokeColor?Cesium.Color.fromCssColorString(i.strokeColor):u,e.polygon.material=i&&i.fillColor?Cesium.Color.fromCssColorString(i.fillColor):c})},selectEntityColor(e){e.polygon.extrudedHeight=.1,e.polygon.outlineColor=p,e.polygon.material=d},loadGeoJson({path:e,styles:t},o){this.loading=!0,Cesium.GeoJsonDataSource.load(e).then(e=>{const i=e.entities.values;i.forEach(e=>{e.polygon.outline=!0,e.polygon.outlineWidth=3,e.polygon.outlineColor=t&&t.strokeColor?Cesium.Color.fromCssColorString(t.strokeColor):u,e.polygon.material=t&&t.fillColor?Cesium.Color.fromCssColorString(t.fillColor):c});const n=i.map(e=>{const t=e.properties,o=t.propertyNames;return{value:o.map(e=>t[e]).toString(),entity:e,properties:o.map(e=>({key:e,value:t[e]._value}))}});this.restaurants=n,a.dataSources.add(e),a.zoomTo(e).then(()=>{this.loading=!1}),"function"===typeof o&&o(n)})}}},y=h,m=(o("2b84"),o("2272")),g=Object(m["a"])(y,l,s,!1,null,null,null),v=g.exports,C={name:"App",components:{CesiumGeoJson:v}},w=C,b=(o("e54a"),Object(m["a"])(w,n,r,!1,null,null,null)),S=b.exports,k=o("2e36"),_=o.n(k);o("5ba9"),o("03b0");i["a"].use(_.a),i["a"].config.productionTip=!1,new i["a"]({render:e=>e(S)}).$mount("#app")},"647f":function(e,t,o){},e54a:function(e,t,o){"use strict";o("5375")}});
//# sourceMappingURL=app.d569dc87.js.map